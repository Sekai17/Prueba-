<!doctype html><html lang=es><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no,minimal-ui"><meta name=theme-color content=#070a14><title>Clicker — Singularidad v3</title><style>
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}html,body{height:100%}body{margin:0;background:#070a14;color:#eaf1ff;font:600 16px/1.2 system-ui,Segoe UI,Roboto;display:grid;place-items:center}
#a{width:min(96vmin,580px);background:#0d1224;border:1px solid #223055;border-radius:20px;box-shadow:0 24px 100px rgba(0,0,0,.55);padding:10px;display:grid;gap:8px}
#hdr{display:grid;grid-template-columns:auto 1fr auto auto;gap:8px;align-items:center}
#ico{font-size:22px}#s{font-weight:900;color:#9cc8ff}
#keys,#buf{font:800 12px/1 system-ui;padding:3px 8px;border-radius:12px;border:1px solid #274;display:grid;place-items:center}
#keys{background:#0a1b17;border-color:#1a4}#buf{background:#2b1630;border-color:#743}
#story{font:600 12px;color:#9db1d8}#n{font:900 40px/1.05 system-ui;letter-spacing:.5px}
#p{height:10px;background:#0a1330;border:1px solid #1e2c55;border-radius:10px;overflow:hidden}#pb{display:block;height:100%;background:linear-gradient(90deg,#6aa8ff,#49f3a1)}
#tap{position:sticky;bottom:0;inset-inline:0;cursor:pointer;border:0;border-radius:16px;padding:18px;background:linear-gradient(180deg,#53f4a6,#2bd07f);color:#07101a;font-weight:1000;font-size:22px;letter-spacing:.6px}
#tap:active{transform:scale(.985)}
#nav{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}#nav>button{all:unset;border:1px solid #243156;background:#0f172a;border-radius:12px;padding:8px 10px;cursor:pointer;text-align:center}
#panels>section{display:none}#panels>section.on{display:grid}#shop{display:grid;gap:8px}
button.b{all:unset;display:grid;grid-template-columns:1fr auto;gap:6px;align-items:center;border:1px solid #243156;background:#101b30;border-radius:14px;padding:12px;cursor:pointer}button.b:active{transform:scale(.99)}
.t{color:#c9e4ff}.c{color:#9bd2ff;font-weight:900}#mis,#rel,#stats{gap:8px}
#mis .m,#rel .r{border:1px solid #243156;background:#0f1730;border-radius:12px;padding:10px}
#bar{display:grid;grid-template-columns:1fr auto auto;gap:6px;align-items:center}
#buy,#auto{all:unset;border:1px solid #243156;background:#0f172a;border-radius:12px;padding:8px 10px;cursor:pointer;font-weight:800}
#gear{all:unset;width:36px;height:36px;border-radius:11px;border:1px solid #243156;background:#10172a;display:grid;place-items:center;cursor:pointer}
#panel{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;place-items:center}
#card{width:min(92vmin,520px);background:#0e1426;border:1px solid #243156;border-radius:16px;padding:12px;display:grid;gap:8px}
#x{all:unset;justify-self:end;border:1px solid #243156;border-radius:10px;padding:6px 10px;background:#111a2e;cursor:pointer}
label{display:flex;justify-content:space-between;align-items:center;font:600 14px system-ui}input[type=checkbox]{width:20px;height:20px}
#toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%);background:#102c1f;border:1px solid #1b5a3e;color:#bfffdc;padding:10px 14px;border-radius:12px;display:none}
small{color:#8aa0c6}
@keyframes g{0%{transform:translate(0)}25%{transform:translate(1px,-1px)}50%{transform:translate(-1px,1px)}75%{transform:translate(1px,1px)}100%{transform:translate(0)}}
</style><body><main id=a>
<div id=hdr><div id=ico>🌱</div><div><div id=s>Planta</div><div id=story>Germina, produce savia y semillas.</div></div><div id=keys>🔑0/2</div><div id=buf>—</div></div>
<div id=n>Ω 0</div>
<div id=bar><div id=p><i id=pb style="width:0%"></i></div><button id=buy>x1</button><button id=auto>▶︎</button></div>
<div id=nav><button data-t=shop>🛒 Tienda</button><button data-t=mis>📜 Misiones</button><button data-t=rel>🔮 Reliquias</button><button data-t=stats>📈 Stats</button></div>
<div id=panels><section id=shop class=on></section><section id=mis></section><section id=rel></section><section id=stats></section></div>
<button id=tap>TOCAR</button><div id=log></div>
<small>Etapas: 🌱 Planta → 🧠 Conciencia → ⛏️ Minería → 🌍 Mundo → ♾️ Singularidad → 🤖 AI → 🌀 Raro → 🐛 Errorezs → 🧩 Glichs</small>
<div style="display:flex;gap:8px;align-items:center;justify-content:space-between"><button id=gear>⚙️</button><div id=sig style="font:800 12px/1 system-ui;color:#8ee0b6;background:#0a1b17;border:1px solid #1d3a31;padding:3px 8px;border-radius:12px">Σ0</div></div>
</main>
<div id=panel><div id=card><button id=x>cerrar</button>
<label>Vibración<input id=hap type=checkbox checked></label>
<label>Reducir movimiento<input id=rm type=checkbox></label>
<label>Auto-avanzar etapas<input id=aadv type=checkbox checked></label>
<label>Guardar cada 5s<input id=asv type=checkbox checked></label>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
<a id=share class=btn style="all:unset;display:grid;place-items:center;border:1px solid #2a3a66;background:#0f1730;border-radius:12px;padding:8px 10px;cursor:pointer">Compartir</a>
<a id=export class=btn style="all:unset;display:grid;place-items:center;border:1px solid #2a3a66;background:#0f1730;border-radius:12px;padding:8px 10px;cursor:pointer">Exportar</a>
<a id=import class=btn style="all:unset;display:grid;place-items:center;border:1px solid #2a3a66;background:#0f1730;border-radius:12px;padding:8px 10px;cursor:pointer">Importar</a>
<a id=reset class=btn style="all:unset;display:grid;place-items:center;border:1px solid #2a3a66;background:#0f1730;border-radius:12px;padding:8px 10px;cursor:pointer">Reset</a></div></div></div>
<div id=toast></div>
<script>
const D=document,$=e=>D.querySelector(e),fmt=n=>Intl.NumberFormat('es-AR',{notation:n>9999?'compact':'standard',maximumFractionDigits:2}).format(n),R=()=>Math.random();
// ---- Estado
let st=0,nm=["Planta","Conciencia","Minería","Dominar el Mundo","Singularidad","AI","Raro","Errorezs","Glichs"],em=["🌱","🧠","⛏️","🌍","♾️","🤖","🌀","🐛","🧩"],lore=["Germina, produce savia y semillas.","Surge la autoconciencia: organiza ideas.","Extrae recursos y automatiza.","Influye mercados y gobiernos.","Tecnología se dispara a infinito.","Modelos que se entrenan solos.","Anomalías y rarezas emergen.","Aparecen errores que mutan todo.","La realidad se rompe y reescribe."],goal=[60,700,7e3,9e4,1.4e6,2.3e7,3.5e8,6e9,1.1e11];
let r=0,tap=1,cps=0,tm=0,rare=.01,crit=.02,h=true,rm=false,aadv=true,bulk=1,autos=false,asvOn=true,sigma=0,rl={},ks=Array(nm.length).fill(0),md=Array(nm.length).fill(0).map(_=>[0,0,0]),buff=0,log=$("#log"),N=$("#n"),PB=$("#pb"),SH=$("#shop"),MIS=$("#mis"),REL=$("#rel"),STATS=$("#stats"),ICO=$("#ico"),S=$("#s"),ST=$("#story"),K=$("#keys"),B=$("#buf"),SIG=$("#sig"),toast=$("#toast");
let ready=false,lastTap=0,combo=0;
// ---- UI helpers
function flash(t){log.textContent=t;setTimeout(()=>log.textContent="",900)}
function toastMsg(t){toast.textContent=t;toast.style.display="block";setTimeout(()=>toast.style.display="none",1200)}
function vibr(n=8){h&&navigator.vibrate?.(n)}
// ---- Upgrades
let up=[{k:"tap",n:"+TOQUE",b:12,m:1.5,info:()=>`+${fmt(Math.max(1,Math.floor(tap*.16)))}/tap`},{k:"auto",n:"AUTO",b:28,m:1.6,info:()=>`+${fmt(Math.max(.1,+(cps*.12).toFixed(2)))}/s`},{k:"caos",n:"CAOS",b:130,m:2.1,info:()=>"raros/crit↑"},{k:"crit",n:"CRIT",b:320,m:2,info:()=>"crit%.↑"},{k:"eff",n:"EFIC",b:210,m:1.85,info:()=>"costos↓"},{k:"patch",n:"PATCH",b:500,m:2,info:()=>"corrupción↓"}].map(u=>({...u,c:0}));
function price(u,i=u.c){let d=u.k=="eff"?1-0.03*u.c:1;return Math.max(1,Math.ceil(u.b*Math.pow(u.m,i)*d))}
function bulkCost(u,q){let sum=0,i=u.c;for(let k=0;k<q;k++)sum+=price(u,i+k);return Math.max(1,Math.ceil(sum))}
function drawShop(){let names=[["Raíz","Hoja","Fotosíntesis"],["Idea","Memoria","Atención"],["Pico","Drill","Minería"],["Medios","Lobby","Dominio"],["Kernel","Núcleo","Compilador"],["Bots","GPU","Autolrn"],["Rift","Anomalía","Caos"],["Patch","Sandbox","Resync"],["Parity","Warp","Stable"]][st];SH.innerHTML="";up.forEach((u,i)=>{let b=D.createElement("button");b.className="b";let t=D.createElement("div");t.className="t";t.textContent=`${names[i%3]||u.n} · ${u.info()}`;let c=D.createElement("div");c.className="c";let cost=bulk==1?price(u):bulkCost(u,bulk);c.textContent="$"+fmt(cost);b.append(t,c);b.onclick=()=>buy(u);SH.append(b)})}
function buy(u){let cost=bulk==1?price(u):bulkCost(u,bulk);if(r<cost)return flash("Faltan Ω");r-=cost;let q=bulk;while(q--){u.c++;if(u.k=="tap")tap+=Math.max(1,Math.floor(tap*.16));if(u.k=="auto"){let add=Math.max(.1,+(cps*.12).toFixed(2));cps+=add}if(u.k=="caos"){rare+=.012;crit+=.002}if(u.k=="crit")crit+=.01}flash("¡Mejora!");drawShop();upd()}
// ---- Draw
function upd(){ICO.textContent=em[st];S.textContent=nm[st];ST.textContent=lore[st];K.textContent="🔑"+ks[st]+"/2";B.textContent=buff>0?"⚡"+Math.ceil((buff-Date.now())/1e3)+"s":(ready?"🟢 listo":"—");N.textContent="Ω "+fmt(r)}
function drawRel(){REL.innerHTML="";let box=D.createElement("div");box.className="r";box.textContent="Activas: "+Object.keys(rl).join(" ");REL.append(box)}
function drawStats(){STATS.innerHTML="";let d=D.createElement("div");d.className="r";d.innerHTML=`Etapa: ${em[st]} ${nm[st]} · Σ${sigma}<br>Ω:${fmt(r)} · tap:${fmt(tap)} · cps:${fmt(cps)} · crit:${(crit*100).toFixed(1)}% · raros:${(rare*100).toFixed(1)}% · claves:${ks.reduce((a,x)=>a+x,0)}<br>Reliquias:${Object.keys(rl).length}`;STATS.append(d)}
function drawMis(){let pct=.6-Math.min(.3,st*.03),need1=Math.ceil(goal[st]*pct),need2=5+st*2,need3=st<2?10+st*10:2*st+2,M=[["Alcanza "+Math.round(pct*100)+"% ("+fmt(need1)+")",r>=need1],["Compra "+need2+" mejoras",up.reduce((a,u)=>a+u.c,0)>=need2],[(st<2?"TOQUE ≥ ":"CPS ≥ ")+need3,(st<2?tap:cps)>=need3]];let c=0;MIS.innerHTML="";M.forEach((m,i)=>{if(m[1]&&!md[st][i]){md[st][i]=1;ks[st]++;toastMsg("Misión: "+m[0]);if(R()<.35)grantRelic()}let div=D.createElement("div");div.className="m";div.textContent=(md[st][i]?"✅ ":"⬜ ")+m[0];MIS.append(div);if(md[st][i])c++});K.textContent="🔑"+ks[st]+"/2"}
function grantRelic(){let all=[["🌿","tap+10%"],["⛏️","cps+15%"],["📈","+1% crit"],["🧪","+15% raros"],["🩹","corrupción-50%"]],avail=all.filter(([k])=>!rl[k]);if(!avail.length)return;let [k,txt]=avail[Math.floor(R()*avail.length)];rl[k]=1;toastMsg("Reliquia "+k+" "+txt);drawRel()}
// ---- Mecánicas
function gateOk(){return ks[st]>=2}
function maybeAdvance(){if(r>=goal[st]&&st<nm.length-1){if(gateOk()){if(aadv){advance()}else{ready=true;PB.style.width="100%";B.textContent="🟢 listo";flash("Listo para avanzar (toca el título)")} }else{flash("Completa 2 misiones para avanzar");PB.style.width="99%";B.textContent="🔒"}}}
function advance(){st++;ready=false;flash("→ "+nm[st]);grantRelic();drawShop();drawMis();drawRel();drawStats();toastMsg("Avance");upd()}
// Tap manual/auto
function t(auto=false){let mult=(1+(st>=3?0.2:0))*(1+(st>=5?0.3:0))*(1+sigma*.05)*(rl["🌿"]?1.1:1)*(buff>0?1.5:1),g=tap*mult;
if(R()<crit+(rl["📈"]?0.01:0)){g*=2;rm||shake()}
if(st>=7&&R()<.02){let m=R()<.5?0.5:2;if(rl["🩹"]&&m<1)m=1-(1-m)/2;r*=m}
r+=g;
if(!auto){let now=Date.now();if(now-lastTap<220){combo++}else{combo=1}lastTap=now;if(combo>=10){buff=now+3000;toastMsg("COMBO!");combo=0}}
auto||drawMis();upd()}
// Tick/idle
function tick(ti){let dt=(ti-tm)/1000;tm=ti;let mult=(1+(st>=4?0.05:0)+(st>=5?0.07:0)+sigma*0.05)*(rl["⛏️"]?1.15:1);r+=cps*dt*mult;
if(st>=6&&R()<((rl["🧪"]?0.015:0)+rare)*dt)r+=goal[st]*(.01+R()*.02);
if(st>=8&&R()<.03&&!rm)shake();
if(buff>0&&Date.now()>buff)buff=0;
upd();
let pr=Math.max(0,Math.min(1,r/goal[st]));PB.style.width=(pr*100)+"%";
maybeAdvance();
requestAnimationFrame(tick)}
function shake(){D.body.style.animation="g .18s linear 2";setTimeout(()=>D.body.style.animation="",280)}
// ---- Persistencia
function save(man=false){let o={st,r,tap,cps,rare,crit,h,rm,aadv,bulk,autos,asvOn,sigma,rl,ks,md,buff,up:up.map(u=>u.c),ts:Date.now()};localStorage.setItem("sing3",JSON.stringify(o));man&&toastMsg("Guardado")}
function load(){let s=localStorage.getItem("sing3");if(!s)return;try{let o=JSON.parse(s);({st,r,tap,cps,rare,crit,h,rm,aadv,bulk,autos,sigma,rl,ks,md,buff}=o);asvOn=o.asvOn??true;o.up&&o.up.forEach((c,i)=>up[i]&&(up[i].c=c));let away=(Date.now()-o.ts)/1000,cap=60*60*8,off=Math.min(away,cap);let mult=(1+(st>=4?0.05:0)+(st>=5?0.07:0)+sigma*0.05)*(rl["⛏️"]?1.15:1);r+=cps*off*mult;toastMsg("Ω offline: "+fmt(cps*off))}catch(e){}}
function daily(){let d=new Date().toDateString();if(localStorage.lastDay!=d){localStorage.lastDay=d;let bonus=100*(1+sigma);r+=bonus;toastMsg("Bono diario +"+fmt(bonus))}}
function prestige(){if(st<nm.length-1||ks[st]<2)return toastMsg("Aún no.");sigma++;SIG.textContent="Σ"+sigma;r=0;tap=1;cps=0;rare=.01;crit=.02;st=0;ks=ks.map(_=>0);md=md.map(_=>[0,0,0]);up.forEach(u=>u.c=0);flash("Prestigio +5%");drawShop();drawMis();drawRel();drawStats();save()}
// ---- Tabs + Controles
function switchTab(t){["shop","mis","rel","stats"].forEach(id=>{$("#"+id).classList.toggle("on",id==t)})}
$("#tap").onpointerdown=e=>{vibr(12);let a=setInterval(()=>t(true),120);let up=()=>{clearInterval(a);D.removeEventListener("pointerup",up);};D.addEventListener("pointerup",up);t()};
$("#buy").onclick=()=>{bulk=bulk==1?10:1;$("#buy").textContent="x"+bulk;drawShop()};
$("#auto").onclick=()=>{autos=!autos;$("#auto").textContent=autos?"⏸︎":"▶︎"};
["shop","mis","rel","stats"].forEach(id=>{$(`[data-t=${id}]`).onclick=()=>switchTab(id)});
$("#gear").onclick=()=>{$("#panel").style.display="grid"};$("#x").onclick=()=>{$("#panel").style.display="none"};
$("#hap").onchange=e=>h=e.target.checked;$("#rm").onchange=e=>rm=e.target.checked;$("#aadv").onchange=e=>aadv=e.target.checked;$("#asv").onchange=e=>asvOn=e.target.checked;
$("#share").onclick=()=>{let txt=`Estoy en ${nm[st]} con Ω ${fmt(r)} y Σ${sigma} · claves ${ks[st]}/2`;navigator.share?navigator.share({title:"Clicker v3",text:txt,url:location.href}).catch(()=>{}):(navigator.clipboard?.writeText(txt),toastMsg("Copiado"))};
$("#export").onclick=()=>{save(true);let s=btoa(localStorage.getItem("sing3")||"{}");navigator.clipboard?.writeText(s);toastMsg("Exportado")};
$("#import").onclick=async()=>{let s=prompt("Pega tu código");if(!s)return;localStorage.setItem("sing3",atob(s));location.reload()};
$("#reset").onclick=()=>{if(confirm("¿Reset?")){localStorage.removeItem("sing3");location.reload()}};
SIG.onclick=()=>prestige();
S.onclick=ICO.onclick=()=>{if(ready&&gateOk())advance()};
document.addEventListener("visibilitychange",()=>{if(document.hidden)autos=false});
// ---- Boot
function init(){load();daily();drawShop();drawMis();drawRel();drawStats();upd();switchTab("shop");SIG.textContent="Σ"+sigma;requestAnimationFrame(tick);setInterval(()=>{autos&&t(true)},220);setInterval(()=>{asvOn&&save()},5e3)}
init();
</script></body></html>